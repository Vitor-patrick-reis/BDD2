-- HABILITA O CONTEXTO
USE EMPRESACJ3029352;
GO

-- CRIAR A TABELA DEPENDENTES
CREATE TABLE DEPENDENTES (
	CODDEPENDENTE INT PRIMARY KEY,
	NOME VARCHAR(35) NOT NULL,
	SEXO CHAR(1) NULL,
	DATANASCIMENTO DATE NOT NULL,
	ID INT FOREIGN KEY REFERENCES
FUNCIONARIOS(ID)
);
GO

-- EXIBE O REGISTRO DEPENDENTES
SELECT * FROM DEPENDENTES;
GO

-- ALTERA O FORMATO DA DATA NO SQL SERVER
SET DATEFORMAT DMY;
GO

-- INSERE OS DADOS NA TABELA DEPENDENTES, UTILIZANDO OS DADOS PROVENIENTES DO ARQUIVO
-- 'DEPENDENTES.CSV', FUNCIONA APENAS EM SERVIDOR "MAC/LINUX"
BULK INSERT DEPENDENTES
	FROM '/DADOS/DEPENDENTES.CSV'
WITH (
	FIRSTROW = 2,
	DATAFILETYPE = 'WIDECHAR',
	FIELDTERMINATOR = ','
);
GO

-- EXIBE O REGISTRO DEPENDENTES
SELECT * FROM DEPENDENTES;
GO

-- INSERE OS DADOS NA TABELA DEPENDENTES, UTILIZANDO OS DADOS PROVENIENTES DO ARQUIVO
-- 'DEPENDENTES.CSV', FUNCIONA APENAS EM SERVIDOR "WINDOWS"
BULK INSERT DEPENDENTES
	FROM N'.../DADOS/DEPENDENTES.CSV'
WITH (
	FIRSTROW = 2,
	DATAFILETYPE = 'WIDECHAR',
	FIELDTERMINATOR = ',',
	CODEPAGE = '65001'
);
GO

-------------------------------
-- JUNÇÕES DE TABELA (JOINS)
-------------------------------

-- EXIBE TODOS OS REGISTROS DA TABELA FUNCIONARIOS
SELECT * FROM FUNCIONARIOS;
GO

-- EXIBE TODOS OS CAMPOS DA TABELA DEPENDENTES
SELECT * FROM DEPENDENTES;
GO

-- REALIZA A JUNÇÃO CRUZADA ENTRE OS DADOS DAS TABELAS FUNCIONARIOS E DEPENDENTES
-- "VERSÃO 1:" SINTAXE ANTIGA
SELECT * FROM FUNCIONARIOS,
			  DEPENDENTES;
GO

-- REALIZA A JUNÇÃO CRUZADA ENTRE OS DADOS DAS TABELAS FUNCIONARIOS E DEPENDENTES
-- "VERSÃO 2:" SINTAXE ANTIGA
SELECT * FROM FUNCIONARIOS CROSS JOIN
			  DEPENDENTES;
GO
